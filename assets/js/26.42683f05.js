(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{362:function(s,t,a){s.exports=a.p+"assets/img/11.3.0.bf554851.jpg"},435:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"extract-parameter"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#extract-parameter"}},[s._v("#")]),s._v(" Extract Parameter")]),s._v(" "),e("p",[s._v("方法：在賦值語句（assignment statement）的一部分抽取成參數。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(362),alt:""}})]),s._v(" "),e("h2",{attrs:{id:"動機"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#動機"}},[s._v("#")]),s._v(" 動機")]),s._v(" "),e("p",[s._v("有時候想要對物件內某個欄位賦值，這個值由另一個物件給予。如果該欄位已經有一個 local value，可以把賦值語句的一部分抽取參數，讓客戶可以指定欄位值。")]),s._v(" "),e("h3",{attrs:{id:"何時會需要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#何時會需要"}},[s._v("#")]),s._v(" 何時會需要？")]),s._v(" "),e("ul",[e("li",[e("em",[s._v("Replace Inheritance with Delegation")]),s._v(" 重構的最後階段，delegating class 會有一個欄位代表其委託對象（受託者，delegatee）："),e("code",[s._v("delegate")]),s._v(" 。但這個欄位需要由客戶來賦值。")])]),s._v(" "),e("p",[s._v("完成這項重構以後，可能會需要 "),e("em",[s._v("Remove Parameter")]),s._v(" 移除沒用的參數。")]),s._v(" "),e("h2",{attrs:{id:"作法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#作法"}},[s._v("#")]),s._v(" 作法")]),s._v(" "),e("ol",[e("li",[s._v("欄位的賦值語句必須在建構式或函式內。如果不在，把它移進去。")]),s._v(" "),e("li",[s._v("實施 "),e("em",[s._v("Add Parameter")]),s._v(" 傳入欄位值，並把欄位型別當作參數型別。\n更改賦值語句，讓欄位獲得參數值。")])]),s._v(" "),e("h2",{attrs:{id:"範例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#範例"}},[s._v("#")]),s._v(" 範例")]),s._v(" "),e("p",[s._v("在 "),e("RouterLink",{attrs:{to:"/ch7/move-embellishment-to-decorator.html"}},[s._v("Move Embellishment to Decorator")]),s._v(" 中，HTML Parser 的 "),e("code",[s._v("DecodingNode")]),s._v(" class 有一個 "),e("code",[s._v("delegate")]),s._v(" 欄位，這個欄位在建構式被賦予新創建的 "),e("code",[s._v("StringNode")]),s._v(" 實體：")],1),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" delegate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringBuffer")]),s._v(" textBuffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" textBegin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" textEnd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n        delegate "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("textBuffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" textBegin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" textEnd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ol",[e("li",[e("p",[s._v("由於 "),e("code",[s._v("delegate")]),s._v(" 已在建構式，因此跳過進行下一步。")])]),s._v(" "),e("li",[e("p",[s._v("實施 "),e("em",[s._v("Add Parameter")]),s._v(" 並設定預設參數為 "),e("code",[s._v("new StringNode(textBuffer, textBegin, textEnd)")]),s._v("。然後修改賦值句。")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" delegate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringBuffer")]),s._v(" textBuffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" textBegin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" textEnd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" newDelegate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n        delegate "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" newDelegate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("這會導致客戶端（"),e("code",[s._v("StringNode")]),s._v("）也必須修改：")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringNode")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("textBuffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" textBegin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" textEnd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("編譯並測試通過之後，實施 "),e("em",[s._v("Remove Parameter")]),s._v(" 幾次，來讓 "),e("code",[s._v("DecodingNode")]),s._v(" 建構式變成如下：")]),s._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" delegate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    \n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DecodingNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" \n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// StringBuffer textBuffer, int textBegin, int textEnd, ")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v(" newDelegate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n            delegate "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" newDelegate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);